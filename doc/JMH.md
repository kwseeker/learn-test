# JMH （Java微基准测试套件）

## 预备知识

+ **基准测试定义**

  基准测试（benchmarking）是一种测量和评估软件性能指标的活动。你可以在某个时候通过基准测试建立一个已知的性能水平（称为基准线），当系统的软硬件环境发生变化之后再进行一次基准测试以确定那些变化对性能的影响。这是基准测试最常见的用途。其他用途包括测定某种负载水平下的性能极限、管理系统或环境的变化、发现可能导致性能问题的条件，等等。

  基准测试的具体做法是：在系统上运行一系列测试程序并把性能计数器的结果保存起来。这些结构称为“性能指标”。性能指标通常都保存或归档，并在系统环境的描述中进行注解。比如说，有经验的数据库专业人员会把基准测试的结果以及当时的系统配置和环境一起存入他们的档案。这可以让他们对系统过去和现在的性能表现进行对照比较，确认系统或环境的所有变化。

  基准测试通常都是些功能测试，即测试系统的某个功能是否达到了预期的要求。有些性能测试工具可以对系统几乎所有的方面（从最常见的操作到最复杂的操作，从小负载到中等负载到大负载）进行测试。

+ **JVM 预热**(Warm-up)

  由于JVM的懒加载及JIT机制等原因，”首次“执行会有额外耗时。

  测试中JVM预热是为了排除上面因素影响，让测试结果更接近被测代码逻辑本身。

  业务中也有用到预热（不单单是JVM预热），多在一些低延迟要求较高的应用中，比如大促等活动。

  > 首次不一定是第一次，还得看JVM对代码具体处理逻辑，比如热点代码需要看计数器阈值。

  